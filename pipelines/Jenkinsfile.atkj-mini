#!groovy
@Library('jenkins-shared-library@master') _

/**
 * @author æ½˜ç»´å‰
 * @description æ ¸å¿ƒPipelineä»£ç  é’ˆå¯¹å°ç¨‹åºé¡¹ç›®CI/CDçš„è„šæœ¬
 * æ³¨æ„ æœ¬æ–‡ä»¶åœ¨Gitä½ç½®å’Œåç§°ä¸èƒ½éšä¾¿æ”¹åŠ¨ é…ç½®åœ¨jenkinsé‡Œ
 */
// Pipelineéœ€è¦å®‰è£…çš„æ’ä»¶

// æ ¹æ®ä¸åŒç¯å¢ƒé¡¹ç›®é…ç½®ä¸åŒå‚æ•°
def map = [:]

// ä¿æŒæ„å»ºçš„æœ€å¤§ä¸ªæ•°
map.put('build_num_keep', 2)

// é»˜è®¤è¦æ„å»ºçš„Gitåˆ†æ”¯
map.put('default_git_branch', 'master')

// æ˜¯å¦Pipelineå†…è„šæœ¬é’‰é’‰é€šçŸ¥  æ€»å¼€å…³
map.put('is_ding_notice', true)
// æ˜¯å¦é€šçŸ¥å˜æ›´è®°å½•
map.put('is_notice_change_log', true)
// æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒå‘å¸ƒæˆåŠŸåè‡ªåŠ¨ç»™Gitä»“åº“æ‰“Tagç‰ˆæœ¬å’Œç”Ÿæˆå˜æ›´è®°å½•
map.put('is_git_tag', true)

// é¡¹ç›®æ ‡ç­¾æˆ–é¡¹ç›®ç®€ç§°
map.put('project_tag', ' ')

// jenkinsåˆ†å¸ƒå¼æ„å»ºèŠ‚ç‚¹åç§°
map.put('jenkins_node', 'macos-mini')

// æ„å»ºç¯å¢ƒå˜é‡
map.put('nodejs', 'Node14')

// ç›¸å…³ä¿¡ä»»æ ‡è¯†
map.put('ci_git_credentials_id', '45392b97-5c21-4451-b323-bbf104f70e51')
map.put('git_credentials_id', '45392b97-5c21-4451-b323-bbf104f70e51')
map.put('ding_talk_credentials_id', '0d24aab8-f1ec-44eb-8e4f-71de9ecd25d5')


// è°ƒç”¨æ ¸å¿ƒé€šç”¨Pipeline
miniSharedLibrary(map)


// ---------------------------------------------------------------------------------------------------------------------

// https://github.com/DreamPWJ/jenkins-shared-library.git  Jenkinsfile.lexiang-mini

/*

ruchen-property-sales-mini
å„’è¾°æˆ¿äº§çº¿ä¸Šå”®æ¥¼å¤„å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/panweiji-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev",
  "PROJECT_CHINESE_NAME" : "å„’è¾°æˆ¿äº§çº¿ä¸Šå”®æ¥¼å¤„",
  "IS_MONO_REPO" : true,
  "IS_MINI_NATIVE_NEED_NPM" : true,
  "PROJECT_NAME" : "ruchen-property-sales",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/ruchen-property-sales-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/ruchen-property-sales-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=BjS03rwxc2d"
}

ruchen-property-sales-manager-mini
å„’è¾°æˆ¿äº§ç½®ä¸šé¡¾é—®å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/panweiji-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev",
  "PROJECT_CHINESE_NAME" : "å„’è¾°æˆ¿äº§ç½®ä¸šé¡¾é—®",
  "IS_MONO_REPO" : true,
  "IS_MINI_NATIVE_NEED_NPM" : true,
  "PROJECT_NAME" : "ruchen-property-sales-manager",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/ruchen-property-sales-manager-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/ruchen-property-sales-manager-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : ""
}

MINI_JOB_INFO
{
"demoUser" : "15555555555" ,
"demoPassword" : "123456"
}

property-sales-mini
æˆ¿äº§åœ¨çº¿é”€å”®å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/panweiji-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev",
  "PROJECT_CHINESE_NAME" : "æˆ¿äº§åœ¨çº¿é”€å”®",
  "IS_MONO_REPO" : true,
  "IS_MINI_NATIVE_NEED_NPM" : true,
  "PROJECT_NAME" : "property-sales",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/property-sales-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/property-sales-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=lzx3erqVPti"
}

property-sales-manager-mini
æˆ¿äº§åœ¨çº¿é”€å”®ç®¡ç†ç«¯å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/panweiji-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev",
  "PROJECT_CHINESE_NAME" : "æˆ¿äº§åœ¨çº¿é”€å”®ç®¡ç†ç«¯",
  "IS_MONO_REPO" : true,
  "IS_MINI_NATIVE_NEED_NPM" : true,
  "PROJECT_NAME" : "property-sales-manager",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/property-sales-manager-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/property-sales-manager-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=5owWYUCZwUr"
}

nursing-access-mini
æŠ¤æŠ¤é€šç”¨æˆ·å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/panweiji-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev",
  "PROJECT_CHINESE_NAME" : "æŠ¤æŠ¤é€šç”¨æˆ·",
  "IS_MONO_REPO" : true,
  "IS_MINI_NATIVE_NEED_NPM" : true,
  "PROJECT_NAME" : "nursing-access",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/nursing-access-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/nursing-access-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=r9KWmxnxgyp"
}

nursing-manager-mini
æŠ¤æŠ¤é€šç®¡ç†å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/panweiji-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev",
  "PROJECT_CHINESE_NAME" : "æŠ¤æŠ¤é€šç®¡ç†",
  "IS_MONO_REPO" : true,
  "IS_MINI_NATIVE_NEED_NPM" : true,
  "PROJECT_NAME" : "nursing-manager",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/nursing-manager-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/nursing-manager-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=IKV6wLVnnvi"
}

coffee-mini
ä¸Šæ°´å’–å•¡å¾®ä¿¡å°ç¨‹åº ğŸ‘½
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/anjia/coffee-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev" ,
  "PROJECT_CHINESE_NAME" : "ä¸Šæ°´å’–å•¡",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/coffee-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/coffee-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=2zfoMxEuCMv"
}

antai-sport-customer-mini
ä¹äº«ä½“è‚²å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji/antai-sport-customer-minipro.git",
  "DEFAULT_GIT_BRANCH" : "dev" ,
  "PROJECT_CHINESE_NAME" : "ä¹äº«ä½“è‚²"
}

community-iot-mini
ç¤¾åŒºå®šä½IoTç”¨æˆ·å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/panweiji-iot/community-iot-mini.git",
  "DEFAULT_GIT_BRANCH" : "dev" ,
  "PROJECT_CHINESE_NAME" : "ç¤¾åŒºå®šä½IoT",
  "MINI_EXPERIENCE_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/community-iot-mini/mini-experience-code-url.jpg",
  "MINI_CODE_URL" : "https://archive-artifacts.oss-cn-beijing.aliyuncs.com/mini/community-iot-mini/mini-code-url.jpg",
  "MINI_URL_SCHEME" : "weixin://dl/business/?t=rSafI9egTHa"
}

health-user-mini
åº·å…»ç”¨æˆ·å¾®ä¿¡å°ç¨‹åº ğŸ‘½
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/smart-health.git",
  "DEFAULT_GIT_BRANCH" : "dev" ,
  "IS_MINI_NATIVE_NEED_NPM" : true ,
  "PROJECT_CHINESE_NAME" : "åº·å…»ç”¨æˆ·"
}

health-manage-mini
åº·å…»ç®¡ç†å¾®ä¿¡å°ç¨‹åº
JSON_PARAMS:
{
  "PROJECT_TYPE" : "1",
  "REPO_URL" : "https://github.com/DreamPWJ/smart-health-manage.git",
  "DEFAULT_GIT_BRANCH" : "dev" ,
  "PROJECT_CHINESE_NAME" : "åº·å…»ç®¡ç†"
}

*/
