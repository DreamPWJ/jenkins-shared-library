#!groovy
@Library('jenkins-shared-library@master') _

/**
 * @author æ½˜ç»´å‰
 * @description æ ¸å¿ƒPipelineä»£ç  é’ˆå¯¹Androidå’ŒiOSé¡¹ç›®CI/CDçš„è„šæœ¬
 * æ³¨æ„ æœ¬æ–‡ä»¶åœ¨Gitä½ç½®å’Œåç§°ä¸èƒ½éšä¾¿æ”¹åŠ¨ é…ç½®åœ¨jenkinsé‡Œ
 */

// æ ¹æ®ä¸åŒç¯å¢ƒé¡¹ç›®é…ç½®ä¸åŒå‚æ•°
def map = [:]

// ä¿æŒæ„å»ºçš„æœ€å¤§ä¸ªæ•°
map.put('build_num_keep', 2)

// é»˜è®¤è¦æ„å»ºçš„Gitåˆ†æ”¯
map.put('default_git_branch', 'master')

// æ˜¯å¦éæ­£å¼ç¯å¢ƒè®¾ç½®Appçš„iconå›¾æ ‡å¾½ç«  æ˜“äºåŒºåˆ†ç¯å¢ƒå’Œç‰ˆæœ¬
map.put('is_icon_add_badge', true)
// æ˜¯å¦Pipelineå†…è„šæœ¬é’‰é’‰é€šçŸ¥  æ€»å¼€å…³
map.put('is_ding_notice', true)
// æ˜¯å¦é€šçŸ¥å˜æ›´è®°å½•
map.put('is_notice_change_log', true)
// æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒå‘å¸ƒæˆåŠŸåè‡ªåŠ¨ç»™Gitä»“åº“æ‰“Tagç‰ˆæœ¬å’Œç”Ÿæˆå˜æ›´è®°å½•
map.put('is_git_tag', true)

// é¡¹ç›®æ ‡ç­¾æˆ–é¡¹ç›®ç®€ç§°
map.put('project_tag', ' ')

// åˆ†å‘å¹³å°è´¦å·
map.put('pgyer_api_key', "a06ee74d4063eb58b7fed20e7fde6306")

// jenkinsåˆ†å¸ƒå¼æ„å»ºèŠ‚ç‚¹labelåç§°  é¢„é…ç½®åœ¨jenkinsèŠ‚ç‚¹ç®¡ç†å†…
map.put('jenkins_node', 'macos-mobile')

// æ„å»ºç¯å¢ƒå˜é‡
map.put('jdk', '8')

// ç›¸å…³ä¿¡ä»»æ ‡è¯†
map.put('ci_git_credentials_id', '45392b97-5c21-4451-b323-bbf104f70e51')
map.put('git_credentials_id', '45392b97-5c21-4451-b323-bbf104f70e51')
map.put('ding_talk_credentials_id', '0d24aab8-f1ec-44eb-8e4f-71de9ecd25d5') // æ”¯æŒå¤šä¸ªç¾¤é€šçŸ¥ é€—å·,åˆ†å‰² ä¸è¦ç©ºæ ¼
// OSSå¯¹è±¡å­˜å‚¨è®¿é—®å‡­æ®é…ç½® Jenkinsç³»ç»Ÿç®¡ç†çš„Manage Credentialsï¼Œç±»å‹é€‰æ‹©ä¸ºâ€œSecret fileâ€é…ç½®
map.put('oss_credentials_id', ' ')
// è·³æ¿æœºæ–¹å¼æœåŠ¡å™¨é›†ç¾¤è‡ªåŠ¨SSHè¿æ¥ä¿¡æ¯ å®ç°CIæ„å»ºæœºå™¨å’Œå¤šå°éƒ¨ç½²æœºä¹‹é—´çš„å…å¯†è¿æ¥
map.put('proxy_jump_hosts_id', ' ')

// Androidåº”ç”¨å•†åº—æ¸ é“å·
map.put('android_store_identify', "lexiang\nhuawei\nxiaomi\noppo\nvivo\nsansumg\nmeizu")

// Androidåº”ç”¨å•†åº—è‡ªåŠ¨åŒ–å®¡æ ¸ä¸Šæ¶
map.put('huawei_app_gallery_client_id', "")
map.put('huawei_app_gallery_client_secret', "")
map.put('xiaomi_market_user_name', "406798106@qq.com")

// Apple Storeç›¸å…³ä¿¡æ¯ æ”¯æŒä¸åŒçš„Apple Storeè´¦å·é…ç½®
map.put('apple_id', "panweiji@163.com")
map.put('apple_password', "panweiji2022")
map.put('apple_team_id', "KTURYE6Q79")

// App Store Connect APIç›¸å…³ä¿¡æ¯  è·å–åœ°å€: https://appstoreconnect.apple.com/access/api
map.put('apple_store_connect_api_key_id', "RK28R5AN27")
map.put('apple_store_connect_api_issuer_id', "")
map.put('apple_store_connect_api_key_file_path', "/Library/AuthKey_RK28R5AN27.p8")

// iOSå®¡æ ¸ä¿¡æ¯
map.put('ios_review_first_name', "æ½˜")
map.put('ios_review_last_name', "ç»´å‰")
map.put('ios_review_phone_number', "+86 18863302302")
map.put('ios_review_email_address', "406798106@qq.com")

// è°ƒç”¨æ ¸å¿ƒé€šç”¨Pipeline
appSharedLibrary(map)


// ---------------------------------------------------------------------------------------------------------------------

// https://github.com/DreamPWJ/jenkins-shared-library.git  Jenkinsfile.panweiji-mobile

/*

panweiji-android-app
ä¹äº«ç”Ÿæ´»ç”¨æˆ·Androidç«¯ ğŸ¤–
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/member/member-android.git",
    "DEFAULT_GIT_BRANCH" : "develop",
    "CUSTOM_ANDROID_BUILD_TYPE" : "Test,PreRelease",
    "IS_ANDROID_STORE_IDENTIFY": true,
    "JDK_VERSION" : "11"
}
ANDROID_APP_INFO:
{
   "huaweiAppGalleryAppId" : "100324957",
   "xiaomiMarketPrivateKey" : ""
}

panweiji-android-mapp
ä¹äº«æœåŠ¡ç®¡ç†Androidç«¯ ğŸ¤–
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/member/member-android-manager.git",
    "DEFAULT_GIT_BRANCH" : "develop",
}

panweiji-saas-android-app
å®‰å®¶Saasç”¨æˆ·Androidç«¯ ğŸš´
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-android.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "CUSTOM_ANDROID_GRADLE_CONFIG_PATH" : "app/build.gradle" ,
    "IS_ANDROID_STORE_IDENTIFY" : true ,
    "CUSTOM_ANDROID_FLAVOR" : "anjia,jinhua,bona,kaifeng,xingyu,huaxin,haoyu"
}
ANDROID_APP_INFO:
{
   "huaweiAppGalleryAppId" : "xxx,104558457,104558455,xxx,105163005,xxx,xxx",
   "xiaomiMarketPrivateKey" : "xxx,xxx,xxx,xxx,wj9i3nlzcpqge6qry8r6jf3ink82vd1qyf9thdma31avfatwn2,xxx,xxx"
}

panweiji-saas-android-mapp
å®‰å®¶Saasç®¡ç†Androidç«¯
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-android-manager.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "CUSTOM_ANDROID_GRADLE_CONFIG_PATH" : "app/build.gradle" ,
    "IS_ANDROID_STORE_IDENTIFY" : true ,
    "CUSTOM_ANDROID_FLAVOR" : "anjia,jinhua,bona,kaifeng,xingyu,huaxin"
}

panweiji-ai-payment-machine
å®‰å®¶ç¼´è´¹ä¸€ä½“æœºAndroidç«¯
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/smart-property/panweiji-ai-payment-machine.git",
}
ANDROID_APP_INFO:
{
   "apkFlavorNames" : "inch19,inch55"
}

------------------------------------------------------------------------------------------------------

panweiji-ios-app
ä¹äº«ç”Ÿæ´»IOSç”¨æˆ·ç«¯ â€ğŸï¸
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/panweiji-mobile/panweiji-mobile-ios.git",
    "DEFAULT_GIT_BRANCH" : "developer",
    "CUSTOM_IOS_BUILD_TYPE" : "Test,PreRelease",
    "IOS_APP_IDENTIFIER" : "com.panweiji.property.store",
    "IOS_PROJECT_LEVEL_DIR" : "panweijiApp"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123456"
}

panweiji-ios-mapp
ä¹äº«æœåŠ¡IOSç®¡ç†ç«¯ â€ğŸï¸
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/panweiji-mobile/ios-anhomemanager.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "IOS_APP_IDENTIFIER" : "com.panweiji.propertyservice.store",
    "IOS_PROJECT_LEVEL_DIR" : "panweijiApp"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123"
}

panweiji-jinhua-ios-app
å®‰å®¶ç”¨æˆ·iOSç«¯-é›†å›¢è´¦å·
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-ios.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "IOS_APP_IDENTIFIER" : "panweiji.com.saasAnjiaJinHua",
    "IOS_PROJECT_LEVEL_DIR" : "saasAnjiaJinHua",
    "IOS_MULTI_TARGET_NAMES" : "anjia,jinhua",
    "IOS_MULTI_TARGET_PARAMS" : "panweiji.com.saasAnjialexiangNew~saaspanweiji,panweiji.com.saasAnjiaJinHua~saasAnjiaJinHua"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123456a"
}

panweiji-jinhua-ios-mapp
å®‰å®¶ç®¡ç†iOSç«¯-é›†å›¢è´¦å·
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-ios-manager.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "IOS_APP_IDENTIFIER" : "panweiji.com.saasMangerJinHua",
    "IOS_PROJECT_LEVEL_DIR" : "saasMangerJinHua",
    "IOS_MULTI_TARGET_NAMES" : "anjia,jinhua",
    "IOS_MULTI_TARGET_PARAMS" : "panweiji.com.saasMangerlexiang~saasMangerpanweiji,panweiji.com.saasMangerJinHua~saasMangerJinHua"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "apple",
   "demoPassword" : "123456"
}

panweiji-saas-ios-app
å®‰å®¶Saasç”¨æˆ·IOSç«¯-ç§‘æŠ€è´¦å·
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-saas-lexiang/anjia-ios-sass.git",
    "IOS_APP_IDENTIFIER" : "panweiji.com.saasAnjialexiangNew",
    "IOS_PROJECT_LEVEL_DIR" : "saasAnjialexiang"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123456a"
}

panweiji-saas-ios-mapp
å®‰å®¶Saasç®¡ç†IOSç«¯-ç§‘æŠ€è´¦å·
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-saas-lexiang/lexiang-ios-sass-manager.git",
    "IOS_APP_IDENTIFIER" : "panweiji.com.saasMangerlexiang",
    "IOS_PROJECT_LEVEL_DIR" : "saasMangerlexiang"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "apple",
   "demoPassword" : "123456"
}


*/
