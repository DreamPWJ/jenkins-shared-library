#!groovy
@Library('jenkins-shared-library@master') _

/**
 * @author 潘维吉
 * @description 核心Pipeline代码 针对Android和iOS项目CI/CD的脚本
 * 注意 本文件在Git位置和名称不能随便改动 配置在jenkins里
 */

// 根据不同环境项目配置不同参数
def map = [:]

// 保持构建的最大个数
map.put('build_num_keep', 2)

// 默认要构建的Git分支
map.put('default_git_branch', 'master')

// 是否非正式环境设置App的icon图标徽章 易于区分环境和版本
map.put('is_icon_add_badge', true)
// 是否Pipeline内脚本钉钉通知  总开关
map.put('is_ding_notice', true)
// 是否通知变更记录
map.put('is_notice_change_log', true)
// 是否在生产环境发布成功后自动给Git仓库打Tag版本和生成变更记录
map.put('is_git_tag', true)

// 项目标签或项目简称
map.put('project_tag', ' ')

// 分发平台账号
map.put('pgyer_api_key', "a06ee74d4063eb58b7fed20e7fde6306")

// jenkins分布式构建节点名称
map.put('jenkins_node', 'macos-mobile')

// 构建环境变量
map.put('jdk', '8')

// 相关信任标识
map.put('ci_git_credentials_id', '45392b97-5c21-4451-b323-bbf104f70e51')
map.put('git_credentials_id', '45392b97-5c21-4451-b323-bbf104f70e51')
map.put('ding_talk_credentials_id', '0d24aab8-f1ec-44eb-8e4f-71de9ecd25d5') // 支持多个群通知 逗号,分割 不要空格

// Android应用商店渠道号
map.put('android_store_identify', "atkj\nhuawei\nxiaomi\noppo\nvivo\nsansumg\nmeizu")

// Android应用商店自动化审核上架
map.put('huawei_app_gallery_client_id', "584688991383585984")
map.put('huawei_app_gallery_client_secret', "5A8DB0038D055A2A6FB7454885381E54FC6EBB38DE18734C07C739408671A8FB")
map.put('xiaomi_market_user_name', "775363390@qq.com")

// Apple Store相关信息
map.put('apple_id', "at_xt2016@163.com")
map.put('apple_password', "Antaijituan2019")
map.put('apple_team_id', "KTURYE6Q79")

// App Store Connect API相关信息
map.put('apple_store_connect_api_key_id', "RK28R5AN27")
map.put('apple_store_connect_api_issuer_id', "69a6de8d-bf99-47e3-e053-5b8c7c11a4d1")
map.put('apple_store_connect_api_key_file_path', "/Library/AuthKey_RK28R5AN27.p8")

// iOS审核信息
map.put('ios_review_first_name', "高")
map.put('ios_review_last_name', "洋")
map.put('ios_review_phone_number', "+86 15063309617")
map.put('ios_review_email_address', "525407426@qq.com")

// 调用核心通用Pipeline
appSharedLibrary(map)


// ---------------------------------------------------------------------------------------------------------------------

// https://github.com/DreamPWJ/jenkins-shared-library.git  Jenkinsfile.an-plus-mobile

/*

an-plus-android-app
乐享生活用户Android端 🤖
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/member/member-android.git",
    "DEFAULT_GIT_BRANCH" : "develop",
    "CUSTOM_ANDROID_BUILD_TYPE" : "DebugT,PreRelease",
    "IS_ANDROID_STORE_IDENTIFY": true,
    "JDK_VERSION" : "11"
}
ANDROID_APP_INFO:
{
   "huaweiAppGalleryAppId" : "100324957",
   "xiaomiMarketPrivateKey" : "8gxuhkzfcw8m7k4c4y3hx3fouojpji9ztcw82phz9ba9kqdkmy"
}

an-plus-android-mapp
乐享服务管理Android端 🤖
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/member/member-android-manager.git",
    "DEFAULT_GIT_BRANCH" : "develop",
}

an-plus-saas-android-app
安家Saas用户Android端 🚴
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-android.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "CUSTOM_ANDROID_GRADLE_CONFIG_PATH" : "app/build.gradle" ,
    "IS_ANDROID_STORE_IDENTIFY" : true ,
    "CUSTOM_ANDROID_FLAVOR" : "anjia,jinhua,bona,kaifeng,xingyu,huaxin,haoyu"
}
ANDROID_APP_INFO:
{
   "huaweiAppGalleryAppId" : "xxx,104558457,104558455,xxx,105163005,xxx,xxx",
   "xiaomiMarketPrivateKey" : "xxx,xxx,xxx,xxx,wj9i3nlzcpqge6qry8r6jf3ink82vd1qyf9thdma31avfatwn2,xxx,xxx"
}

an-plus-saas-android-mapp
安家Saas管理Android端
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-android-manager.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "CUSTOM_ANDROID_GRADLE_CONFIG_PATH" : "app/build.gradle" ,
    "IS_ANDROID_STORE_IDENTIFY" : true ,
    "CUSTOM_ANDROID_FLAVOR" : "anjia,jinhua,bona,kaifeng,xingyu,huaxin"
}

antai-ai-payment-machine
安家缴费一体机Android端
JSON_PARAMS:
{
    "PROJECT_TYPE" : "1",
    "REPO_URL" : "https://github.com/DreamPWJ/smart-property/antai-ai-payment-machine.git",
}
ANDROID_APP_INFO:
{
   "apkFlavorNames" : "inch19,inch55"
}

------------------------------------------------------------------------------------------------------

an-plus-ios-app
乐享生活IOS用户端 ‍🍏️
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/antai-mobile/antai-mobile-ios.git",
    "DEFAULT_GIT_BRANCH" : "developer",
    "CUSTOM_IOS_BUILD_TYPE" : "Test,PreRelease",
    "IOS_APP_IDENTIFIER" : "com.antai.property.store",
    "IOS_PROJECT_LEVEL_DIR" : "AntaiApp"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123456"
}

an-plus-ios-mapp
乐享服务IOS管理端 ‍🍏️
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/antai-mobile/ios-anhomemanager.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "IOS_APP_IDENTIFIER" : "com.antai.propertyservice.store",
    "IOS_PROJECT_LEVEL_DIR" : "AntaiApp"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123"
}

an-plus-jinhua-ios-app
安家用户iOS端-集团账号
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-ios.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "IOS_APP_IDENTIFIER" : "Antai.com.saasAnjiaJinHua",
    "IOS_PROJECT_LEVEL_DIR" : "saasAnjiaJinHua",
    "IOS_MULTI_TARGET_NAMES" : "anjia,jinhua",
    "IOS_MULTI_TARGET_PARAMS" : "Antai.com.saasAnjiaAtkjNew~saasAntaikeji,Antai.com.saasAnjiaJinHua~saasAnjiaJinHua"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123456a"
}

an-plus-jinhua-ios-mapp
安家管理iOS端-集团账号
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-jinhua/anjia-jinhua-ios-manager.git",
    "DEFAULT_GIT_BRANCH" : "dev",
    "IOS_APP_IDENTIFIER" : "Antai.com.saasMangerJinHua",
    "IOS_PROJECT_LEVEL_DIR" : "saasMangerJinHua",
    "IOS_MULTI_TARGET_NAMES" : "anjia,jinhua",
    "IOS_MULTI_TARGET_PARAMS" : "Antai.com.saasMangerAtkj~saasMangerAntaikeji,Antai.com.saasMangerJinHua~saasMangerJinHua"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "apple",
   "demoPassword" : "123456"
}

an-plus-saas-ios-app
安家Saas用户IOS端-科技账号
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-saas-atkj/anjia-ios-sass.git",
    "IOS_APP_IDENTIFIER" : "Antai.com.saasAnjiaAtkjNew",
    "IOS_PROJECT_LEVEL_DIR" : "saasAnjiaAtkj"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "19912522910",
   "demoPassword" : "123456a"
}

an-plus-saas-ios-mapp
安家Saas管理IOS端-科技账号
JSON_PARAMS:
{
    "PROJECT_TYPE" : "2",
    "REPO_URL" : "https://github.com/DreamPWJ/anjia-saas-atkj/atkj-ios-sass-manager.git",
    "IOS_APP_IDENTIFIER" : "Antai.com.saasMangerAtkj",
    "IOS_PROJECT_LEVEL_DIR" : "saasMangerAtkj"
}
IOS_APP_REVIEW_INFO:
{
   "demoUser" : "apple",
   "demoPassword" : "123456"
}

*/
